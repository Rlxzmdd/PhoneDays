<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>倒计时页面</title>
  <style>
    body {
      font-family: apple-system, BlinkMacSystemFont, Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      /* padding-top: -1vh; */
      height: 98vh;
      background-color: #C2B2A8; /* 默认沙褐色 */
      background-size: cover;
      background-repeat: no-repeat;
    }
.container {
  width: 320px;
  height: 200px;
  background-color: #fff;
  border-radius: 28px; /* 增加到28px，接近苹果的G3曲率 */
  box-shadow: 0 32px 64px rgba(0, 0, 0, 0.2);
  display: static;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 20px;
  text-align: center;
}

.title {
  font-size: 20px;
  line-height: 25px;
  font-weight: bold;
  background-color: #F5E9DD;
  padding: 10px 0;
  width: 100%;
  border-radius: 12px; /* 增加到12px，使圆角更柔和 */
}

    .countdown {
      line-height: 134px;
      font-size: 118px;
      font-weight: bold;
      color: #333;
      font-family: "Times New Roman", "Baskerville", apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif;
    }

    .target-date {
      font-size: 18px;
      font-weight: light;
      font-family: apple-system, BlinkMacSystemFont, Arial, sans-serif;
      line-height: 20px;
    }

  </style>
</head>
<body>

<div class="container">
  <div class="title" id="title">标题</div>
  <div class="countdown" id="days">0</div>
  <div class="target-date" id="target-date">目标日</div>
</div>

<script>
  // 获取 URL 中的参数
  function getQueryParams() {
    const params = new URLSearchParams(window.location.search);
    return {
      title: params.get('title'),
      date: params.get('date'),
      body_color: params.get('body_color'),
      title_color: params.get('title_color'),
      title_text_color: params.get('title_text_color')
    };
  }

  // 计算目标日期距离今天的天数（根据用户所在时区）
  function calculateDays(targetDate) {
    const now = new Date();
    const userTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
    const target = new Date(new Date(targetDate).toLocaleString('en-US', { timeZone: userTimeZone }));
    const diffTime = target - now;
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    return diffDays;
  }
  // 从莫兰迪色系中随机获取一组颜色
  function getRandomMorandiColor() {
    const morandiColors = [
    // [页面背景颜色, 标题按钮背景色, 标题按钮文字色]
    // 1.米灰色, 淡橘色, 白色
    // ['#C5B8A5', '#EAD2C7', '#FFFFFF'], 
    // 2.柔绿灰, 靛蓝色, 白色
    ['#A8B3A3', '#465A65', '#FFFFFF'], 
    // 3.浅杏色, 深灰蓝, 米色
    ['#EBD8D1', '#6D6D75', '#FFFFFF'], 
    // 4.浅粉灰, 暗墨蓝, 米白色
    ['#D4BAB6', '#4A5568', '#FFFFFF'], 
    // 5.淡橄榄色, 暗红褐色, 白色
    ['#A9A691', '#8D5B4C', '#FFFFFF'], 
    // 6.米黄色, 深靛色, 浅灰白色
    ['#E5D3B3', '#4B5262', '#F8F8F8'], 
    // 7.灰绿, 棕褐色, 白色
    ['#A4AFA0', '#6E4C44', '#FFFFFF'], 
    // 8.柔灰蓝, 棕褐色, 白色
    ['#9BA7B1', '#5D524C', '#FFFFFF'], 
    // 9.浅棕色, 青绿灰, 白色
    ['#CAB8A2', '#6C8274', '#FFFFFF'], 
    // 10.浅灰蓝, 暗紫灰, 白色
    ['#B6C1C3', '#524859', '#FFFFFF'], 
    // 11.沙黄色, 深青蓝, 白色
    ['#DACBAA', '#4A5A70', '#FFFFFF'], 
    // 12.灰褐色, 灰紫色, 米白色
    ['#B9A593', '#776569', '#FFFFFF'], 
    // 13.苍灰色, 暗紫色, 白色
    ['#A5A7A1', '#57435D', '#FFFFFF'], 
    // 14.浅米色, 海军蓝, 白色
    ['#E7DACC', '#3D5C76', '#FFFFFF'], 
    // 15.灰杏色, 青蓝灰, 白色
    ['#C7B4A2', '#4F6F7C', '#FFFFFF'], 
    // 16.浅灰紫, 棕灰色, 白色
    ['#D4C4C3', '#6A5E5E', '#FFFFFF']
];
    const randomIndex = Math.floor(Math.random() * morandiColors.length);
    return morandiColors[randomIndex];
  }

  // 初始化页面内容
  function initPage() {
    const { title, date, body_color, title_color,title_text_color } = getQueryParams();
    const days = calculateDays(date);

    // 设置标题和日期
    document.getElementById('title').textContent = title ? title : '未设置标题';
    document.getElementById('days').textContent = days > 0 ? days : '0';
    document.getElementById('target-date').textContent = date ? `${date}` : '';

    // 设置颜色，如果未设置则使用随机莫兰迪色系
    const [defaultBodyColor, defaultTitleColor, defaultTitleTextColor] = getRandomMorandiColor();
    document.body.style.backgroundColor = body_color ? body_color : defaultBodyColor;
    document.getElementById('title').style.backgroundColor = title_color ? title_color : defaultTitleColor;
    document.getElementById('title').style.color = title_text_color ? title_text_color : defaultTitleTextColor;
    document.getElementById('days').style.color = title_color ? title_color : defaultTitleColor;
    document.getElementById('target-date').style.color = title_color ? title_color : defaultTitleColor;
  }

  // 执行初始化
  window.onload = initPage;
</script>

</body>
</html>
